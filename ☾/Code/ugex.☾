ó±€˜ winder:
    âŠ¢ __init__(ğ•Š, ğšŒ, ğš’=ó·°¾):
        ğ•Šô€²Ÿ,ğ•Šô€²«,ğ•Šô€³© = ğšŒ,ğš’,â
    __bool__ = ğ•Šâ†¦ğ•Šô€²«+1<ğ•Šô€²ŸğŸƒŒ
    __repr__ = ğ•Šâ†¦â€¹[âŸ¦ğ•Šô€²Ÿï¹•ôŠ¶Šô€´ºâ‚Šâ‚âŸ–ğ˜€âŸ§â”‚âŸ¦ğ•Šô€²ŸôŠ¶Šô€´ºâ‚Šâ‚ï¹•âŸ•ğ˜€âŸ§]âŸ¨âŸ¦ğ•Šô€³©â¨ğ˜€âŸ§âŸ©â€º
    peek = ğ•Šâ†¦ğ•Šô€²ŸôŠ¶Šô€´ºâ‚Šâ‚
    next = ğ•Šâ†¦ğ•Šô€²ŸôŠ¶Šô€´ºô¸™â‚Šâ‚
    note = ğ•Šâ†¦ğ•Šô€³©.append(ğ•Šô€²«) â†’â–º ğ•Š
    eton = ğ•Šâ†¦   ğ•Šô€³©.popî®¦    â†’â–º ğ•Š
    wind = ğ•Šâ†¦ğ•Šô€²«â‰”ğ•Šô€³©.popî®¦    â†’â–º ğ•Š

ARROW_TARG = â
âŠ¢ ó·¹—Â´(x,s=â€):
    ğšŠ = ARROW_TARGô¨„
    Â¿sâ‰…â€: ğšŠ.append(x); â†ªx
    Â¿sâ‰¡âˆ: ğšŠ.extend(x); â†ªx
    ğšŠ.extend(hâ‰”xâ›¶Ë¢); â†ªh
âŠ¢ ó·¹˜Â´(s=â€):
    ğšŠ = ARROW_TARGô¨„
    Â¿sâ‰…â€: â†ªğšŠ.pop(ó·°¾)
    Â¿sâ‰¡âˆ: r=ğšŠï¹•; ó°†´ğšŠï¹•; â†ªr
    Â¿só·¸Šâ‹…ó·°¾â­¢â‰¡0: â†ªâ
    r=ğšŠâ‚›ï¹•; ó°†´ğšŠâ‚›ï¹•; â†ªr
âŠ¢ â–Â´(s=â€):
    ğšŠ = ARROW_TARGô¨„
    Â¿sâ‰…â€: â†ªğšŠô¨„
    Â¿sâ‰¡âˆ: â†ªğšŠï¹•
    Â¿só·¸Šâ‹…ó·°¾â­¢â‰¡0: â†ªâ
    â†ªğšŠâ‚›ï¹•
ó·¹—Â´,ó·¹˜Â´,â–Â´ = ó·¹—Â´â‹„ó·¹˜Â´â‹„â–Â´á´OPWRAP_
UGX_CREATE = â¥Œx,d=âœ—â†¦ó·º»UGX_RUN(winder(ğ‘™(âŸ)), x)â‰•yâ‰…â€ â­œdâ­ yâ‚€

âŠ¢ UGX_SCAN(ğšš, Æ’, ğ—†):
    Â¿Â¬ğšš: â†ª ğ—†â‰¡â›î â­œââ­â€
    ğ‘¥ = Æ’(ğšš.peekî®¦)
    V = ğšš.nextî®¦â‰•pâ‰…ó°®ˆ âˆ¨ ğ‘¥â‰…ó°®ˆ â­œââ­ pâ›¶
    Â¿ğ—†â‰¡á¦    : â†ª ğ‘¥â­œVâ­â€
    Â¿ğ—†â‰¡â›ôŠ½¬   : â†ª ğ‘¥â­œâ€â­â
    Â¿ğ—†â‰¡â›ô‹…‹   : â†ª ğ‘¥â­œââ­â€
    Â¿ğ—†â‰¡â›âºâˆ§Â¬ğ‘¥: â†ª â€
    Â¿ğ—†â‰¡â›î âˆ§Â¬ğ‘¥: â†ª â
    â°ğšš:
        Â¿Â¬Æ’(ğšš.peekî®¦): â‡¥
        Â¿ğšš.nextî®¦â‰•pâ‰‡ó°®ˆ: V.append(p)
    â†ª V
âŠ¢ UGX_RUN(ğšš, ğš):
    ğ—, â ¤ğ–  = ğš
    Â¿ğ—á¹ğ—™:
        ğ—†, = ğ– 
        â†ª UGX_SCAN(ğšš, ğ—, ğ—†)
    â¸˜ğ—âˆˆâ›Bâ›P:
        ğ—Œ,ğ—†,ğ—‹,ğ–¼ = ğ–  î¬¦ stack, mod, reduce, content
        ARROW_TARG.append(ğ—Œ)
        
        ğšš.noteî®¦ â–º Vâ‰”râ‰”UGX_RUN(ğšš, ğ–¼)
        Â¿ğ—†â‰¡â›ô‹…‹: ğšš.windî®¦ â–º Vâ‰”(râ‰…â€  â­œâ€â­ â)
        â¸˜ğ—†â‰¡â›ôŠ½¬: ğšš.windî®¦ â–º Vâ‰”(râ‰…â€  â­œââ­ â€)
        â¸˜râ‰…â€ : ğšš.windî®¦ â–º Vâ‰”(ğ—†â‰¡â›ô‹ â­œââ­ â€)
        â¸˜ğ—†â‰ á¦:
            â°ğšš:
                ğšš.noteî®¦ â–º râ‰”UGX_RUN(ğšš, ğ–¼)
                Â¿râ‰…â€:
                    ğšš.windî®¦
                    â‡¥
                ğšš.etonî®¦ â–º V.extend(r)
            ğšš.etonî®¦
        Â¿ğ—‹â‰…ó°®ˆ: V = â
        Â¿Vâ‰‡â€ âˆ§ ğ—‹â‰‡â–¡: Vó·¸Šâˆ˜áµœğ—‹ î¬¦ ó°¤± more âˆ types?
        ARROW_TARG.pop(ó·°¾)
        Â¿Vâ‰…â€: â†ªV
        â†ª V á£†ô¾’ô‹¤ô‹‚á´® â›¶
    â¸˜ğ—âˆˆâ›âˆ§â›âˆ¨:
        Â¿ğ—â‰¡â›âˆ§:
            ğšš.noteî®¦ â–º Vâ‰”â
            âˆ€Uâˆˆğ– :
                Â¿UGX_RUN(ğšš, U)â‰•râ‰…â€: â†ªğšš.windî®¦â–ºâ€
                V.extend(r)
            â†ª ğšš.etonî®¦ â–º V
        â¸˜ğ—â‰¡â›âˆ¨:
            âˆ€Uâˆˆğ– :
                ğšš.noteî®¦
                Â¿UGX_RUN(ğšš, U)â‰•râ‰‡â€: â†ªğšš.etonî®¦â–ºr
                ğšš.windî®¦
        â†ª â€

î¬¦ âŸ¨âŸ¨ó·º¹ó·¹—>2â® ó·º¹<â–â®î âŸ© ó·¸´ â´³âŸ©î âˆ˜[3,2,1,2,2,7] â†’ â˜¾
î¬¦ âŸ¨âŸ¨ó·º¹ó·¹—>2â® ó·º¹<â–â®î âŸ© ó·¸´ â´³âŸ©î âˆ˜[1,2,3,2,4,5,1,9,1] â†’ â˜¾
î¬¦ âŸ¨âŸ¨ó·º¹ó·¹—%2â® ó·º¹<â–â®î  âˆ á´™âŸ© ó·¸´ â´³âŸ©î âˆ˜[0,0,1,ó·°¿,ó·±‚,0,5,2,1,10] â†’ â˜¾
î¬¦ âŸ¨âŸ¨(ó·º¹>1 âˆ á´™)âº ó·º¹<5â®î  âˆ ó·º¹â¨ğ˜€âŸ© ó·¸´ ó°»¾ âˆó·º¹â¨â€¹â€¦â€¦â€¦â€ºâŸ©î âˆ˜[1,2,3,4,0,0,0,1,1,8,5,9,0] â†’ â˜¾