â®Œ pickle â¨¡ loads as pl, dumps as pd

ó±€˜ Cacher:
    âŠ¢ __init__(ğ•Š,Æ’,ğ˜©,ğ˜¦,ğ˜¥):
        ğ•ŠôŠ½º,ğ•Šôºª,ğ•Šôº¤,ğ•Šôº¢,ğ•Šô€ = Æ’,ğ˜©,ğ˜¦,ğ˜¥,{}
    âŠ¢ __call__(ğ•Š,â ¤ğ”¸,â ¶ğ•‚):
        ğš=ğ•Šôºª(ğ•ŠôŠ½º.__name__,â ¤ğ”¸,â ¶ğ•‚)
        Â¿ğ•Š.chk_cache(ğš)â‰•vâ‰‡â€: â†ª ğ•Šôº¢(v)
        v=ğ•ŠôŠ½º(â ¤ğ”¸,â ¶ğ•‚)
        ğ•Š.add_cache(ğš,ğ•Šôº¤(v))
        â†ª v
    âŠ¢ chk_cache(ğ•Š,x  ): â†ªğ•Šô€.get(x,â€)
    âŠ¢ add_cache(ğ•Š,x,y): â†ªğ•Šô€â‚“â‰”y

ó±€˜ FileCacher(Cacher):
    âŠ¢ __init__(ğ•Š,Æ’,ğ˜©,ğ˜¦,ğ˜¥,fp=TMPDIR/â€¹â˜¾_cacheâ€º):
        super().__init__(Æ’,ğ˜©,ğ˜¦,ğ˜¥)
        ğ•Šô€²¥ô€²¹=mkd(fp)
    âŠ¢ chk_cache(ğ•Š,x):
        Â¿xâˆˆğ•Šô€: â†ªğ•Šô€â‚“
        Â¿(ğ•Šô€²¥ô€²¹/xâ‰•f).existsî®¦: â†ªğ•Šô€â‚“â‰”î¸½áµ‡(f)
        â†ªâ€
    âŠ¢ add_cache(ğ•Š,x,y): î¸¶áµ‡(ğ•Šô€²¥ô€²¹/x, ğ•Šô€â‚“â‰”y)

mkmk_cache = Æ‡â†¦â¥Œğ˜©=sha,ğ˜¦=pd,ğ˜¥=pl,â ¤ğ˜ˆ,â ¶ğ˜’â†¦Æ’â†¦Æ‡(Æ’,ğ˜©,ğ˜¦,ğ˜¥,â ¤ğ˜ˆ,â ¶ğ˜’)
cache, fcache = Cacherâ‹„FileCacher á´ mkmk_cache

__exports__ = â€¹Cacherâ€‰FileCacherâ€‰cacheâ€‰fcacheâ€ºâ­

î¬¦ sqc = mk_fcache(fp="/tmp/weed")(â˜¾â—‹âˆš)
î¬¦ sqc(5)
î¬¦ sqc(5)