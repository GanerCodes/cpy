FORCE_INCLUDE = ó°¦¥ó°¦¥ó°¦¥ó°¦¥ó°¦¥ Óï½œâ”‚ï¼‹ï¼ï¼¼ï¼ƒï¼ï¼œÆ§â™ºâ†‹â†Šâ…„Î›â”´É¹Ô€Ë¥Êâ„²ÆÆ†ÊÊÊŒÊ‡É¹É¯ÊÉ¾á´‰É¥ÆƒÉŸÇÉ”Éğ¤ğ¦ğ§ğ©ğªğ¬ğ¾ğŠğŒğğğğ‘ğ’ğ“ğ•ğ–ğ—ğ˜ğ™ğšğ›ğœğğğŸğ ğ¡ğ¢ğ£ğ¤ğ¥ğ¦ğ§ğ¨ğ©ğªğ«ğ¬ğ­ğ®ğ¯ğ°ğ±ğ²ğ³ğ´ğµğ¶ğ·ğ¸ğ¹ğºğ»ğ¼ğ½ğ¾ğ¿ğŸ€ğŸğŸ‚ğŸƒğŸ„ğŸ…ğŸ†ğŸ‡ğŸˆğŸ‰ğ“ğ“‘ğ“’ğ““ğ“”ğ“•ğ“–ğ“—ğ“˜ğ“™ğ“šğ“›ğ“œğ“ğ“ğ“Ÿğ“ ğ“¡ğ“¢ğ“£ğ“¤ğ“¥ğ“¦ğ“§ğ“¨ğ“©ğ“ªğ“«ğ“¬ğ“­ğ“®ğ“¯ğ“°ğ“±ğ“²ğ“³ğ“´ğ“µğ“¶ğ“·ğ“¸ğ“¹ğ“ºğ“»ğ“¼ğ“½ğ“¾ğ“¿ğ”€ğ”ğ”‚ğ”ƒğŸ„°ğŸ„±ğŸ„²ğŸ„³ğŸ„´ğŸ„µğŸ„¶ğŸ„·ğŸ„¸ğŸ„¹ğŸ„ºğŸ„»ğŸ„¼ğŸ„½ğŸ„¾ğŸ„¿ğŸ…€ğŸ…ğŸ…‚ğŸ…ƒğŸ…„ğŸ……ğŸ…†ğŸ…‡ğŸ…ˆğŸ…‰ĞĞ‘Ğ’Ğ“Ğ”Ğ•Ğ–Ğ—Ğ˜Ğ™ĞšĞ›ĞœĞĞĞŸĞ Ğ¡Ğ£Ğ¤Ğ¥Ğ¦Ğ§Ğ¨Ğ©ĞªĞ«Ğ¬Ğ­Ğ®Ğ¯Ğ°Ğ±Ğ²Ğ³Ğ´ĞµĞ¶Ğ·Ğ¸Ğ¹ĞºĞ»Ğ¼Ğ½Ğ¾Ğ¿Ñ€ÑÑ‚ÑƒÑ„Ñ…Ñ†Ñ‡ÑˆÑ‰ÑŠÑ‹ÑŒÑÑÑÎ‘Î’Î•Î–Î—Î™ÎšÎ›ÎœÎÎŸÎ¡Î¤Î¥Î¿ã€Šã€‹ï½Ÿï½ ã€”ã€•ã€ã€‘â¥â¥‘â¥œâ¥ â¥â¥¡â¦‹â¦Œâ¢¨â¡…Â£Öâ«¾âˆ¥ğœ‹â˜ƒâˆ›âˆœÃ˜â¨„â‹’â©€â¨†âˆ¬âˆ­â¨Œâˆ®âˆ¯âˆ°âˆ±â¨‘âˆ²âˆ³â¨•â¨–Ã¦Ã†â†®â‹‰â‹Šâ¨²â‹ˆâ‰€â’â•±â™­â«šÑµÂ¶á¶¨â‹â‹â©„â©…â©‘â©’â©“â©”â©•â©–â©™â©šâ©›â©œâ©â©â©Ÿâ© â©¢â©£ ó°¦¥ó°¦¥ó°¦¥ó°¦¥ó°¦¥

MULTICHARS = ó°¦¥ó°¦¥ó°¦¥ó°¦¥ó°¦¥ ğ“µğ“·â€‰ğ“µğ“°â€‰ğ˜ğ—¿â€‰ğ—¦ğ—Ÿâ€‰ğ—šğ—Ÿâ€‰ğ—¿ğ—¸â€‰ğ˜€ğ˜â€‰ğ—ªâµâ€‰ğ—˜ğ—»ğ—±â€‰ğ—”ğ˜‚ğ˜â€‰ğ—šğ—®ğ—¹â€‰ğ—¸ğ—²ğ—¿â€‰ğ“µğ“¸ğ“°â€‰ğ˜€ğ—¶ğ—»â€‰ğ—°ğ—¼ğ˜€â€‰ğ˜ğ—®ğ—»â€‰ğ˜€ğ—²ğ—°â€‰ğ—°ğ˜€ğ—°â€‰ğ—°ğ—¼ğ˜â€‰ğ—”ğ˜€ğ˜€â€‰ğ—®ğ—¿ğ—´â€‰ğ—ºğ—¶ğ—»â€‰ğ—ºğ—®ğ˜…â€‰ğ—²ğ˜…ğ—½â€‰ğ—±ğ—¶ğ˜ƒâ€‰ğ—±ğ—²ğ˜â€‰ğ—±ğ—²ğ—´â€‰ğ—²ğ—¿ğ—³â€‰ğ—¶ğ—»ğ˜â€‰ğ—´ğ—°ğ—±â€‰ğ—¹ğ—°ğ—ºâ€‰ğ—µğ—¼ğ—ºâ€‰ğ—¼ğ—¯ğ—·â€‰ğ—¹ğ—¶ğ—ºâ€‰ğ—¶ğ—»ğ—³â€‰ğ˜€ğ˜‚ğ—½â€‰ğ—ºğ—¼ğ—±â€‰ğ—£ğ—šğ—Ÿâ€‰ğ—£ğ—¦ğ—Ÿâ€‰ğ˜€ğ—´ğ—»â€‰ğ˜ğ—¼ğ—¿â€‰ğ˜„ğ—¿ğ˜â€‰ğ—ªğ—§ğ—¦â€‰ğ—ªğ—§*â€‰ğ˜ƒğ—®ğ—¿â€‰ğ˜€ğ˜ğ—±â€‰ğ—°ğ—¼ğ˜ƒâ€‰ğ—¦ğ—£ğ—˜ğ—–â€‰ğ—¦ğ—œğ—¡ğ—›â€‰ğ—–ğ—¢ğ—¦ğ—›â€‰ğ—§ğ—”ğ—¡ğ—›â€‰ğ—¦ğ—˜ğ—–ğ—›â€‰ğ—–ğ—¦ğ—–ğ—›â€‰ğ—–ğ—¢ğ—§ğ—›â€‰ğ—–ğ—›ğ—”ğ—¥â€‰ğ—–ğ—¨ğ—¥ğ—Ÿâ€‰ğ—™ğ—¥ğ—¢ğ—•â€‰ğ—šğ—¥ğ—”ğ——â€‰ğ—¥ğ—”ğ—¡ğ—â€‰ğ—¦ğ—£ğ—”ğ—¡â€‰ğ—ªğ—Ÿğ—¢ğ—šâ€‰ğ—˜ğ—¥ğ—™ğ—–â€‰ğ— ğ—˜ğ— ğ—˜â€‰ğ—¡ğ—¨ğ—Ÿğ—Ÿâ€‰ğ—©ğ—¢ğ—œğ——â€‰ğ—–ğ—¢ğ—¥ğ—¥ ó°¦¥ó°¦¥ó°¦¥ó°¦¥ó°¦¥

SCRIPT_EXIST = ó°¦¥ó°¦¥ó°¦¥ó°¦¥ó°¦¥
abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789Î±Î²Î³Î´ÎµÎ¶Î·Î¸Ï‘Î¹ÎºÎ»Î¼Î½Î¾Ï€ÏÏ‚ÏƒÏ„Ï…Ï†Ï‡ÏˆÏ‰âˆ‚Ï•Î“Î”âˆ‡Î˜ÎÎ Î£Î¦Î¨Î©,<>;+-*=()[]{}~?&$%:!
â‚î …î î â‚‘î î ‘â‚•áµ¢â±¼â‚–â‚—â‚˜â‚™ó°‚¼â‚šî †áµ£â‚›â‚œáµ¤áµ¥î ’â‚“î “î ”ó°‚“ó°‚”ó°‚•ó°‚–ó°‚—ó°‚˜ó°‚™ó°‚šó°‚›ó°‚œó°‚ó°‚ó°‚Ÿó°‚ ó°‚¡ó°‚¢ó°‚£ó°‚¤ó°‚¥ó°‚¦ó°‚§ó°‚¨ó°‚©ó°‚ªó°‚«ó°‚¬â‚€â‚â‚‚â‚ƒâ‚„â‚…â‚†â‚‡â‚ˆâ‚‰ó°ƒ¤ó°ƒ¥ó°ƒ¦ó°ƒ§ó°ƒ¨ó°ƒ©ó°ƒªó°ƒ«â—Œó°ƒ¬ó°ƒ­ó°ƒ®ó°ƒ¯ó°ƒ°ó°ƒ±ó°ƒ³ó°ƒ´ó°ƒµó°ƒ¶ó°ƒ·ó°ƒ¸ó°ƒ¹ó°ƒºó°ƒ»ó°ƒ¼â—Œâ—Œó°ƒó°ƒâ—Œó°ƒ“ó°ƒ™ó°ƒ›ó°ƒó°ƒ ó°ƒ¢ó°ƒ£ó°„ó°„Ÿó°„ó°„â‚Šâ‚‹î ‰â‚Œâ‚â‚ó°„—ó°„˜ó°„•ó°„–Ë·ï¹–ï¹ ï¹©ï¹ªï¹•â—Œ
áµƒáµ‡á¶œáµˆáµ‰á¶ áµÊ°â±Ê²áµË¡áµâ¿áµ’áµ–î ‡Ê³Ë¢áµ—áµ˜áµ›Ê·Ë£Ê¸á¶»á´¬á´®ó°€‚á´°á´±ó°€…á´³á´´á´µá´¶á´·á´¸á´¹á´ºá´¼á´¾ó°€á´¿ó°€’áµ€áµâ±½áµ‚ó°€—ó°€˜ó°€™â°Â¹Â²Â³â´âµâ¶â·â¸â¹ó°Œó°ó°ó°ó°ó°‘ó°’ó°“â—Œó°”ó°•ó°–ó°—ó°˜ó°™ó°›ó°œó°ó°ó°Ÿó° ó°¡ó°¢ó°£ó°¤â—Œâ—Œó°€¶ó°€·â—Œó°€»ó°ó°ƒó°…ó°ˆó°Šó°‹ó°±ó°‚‚ó°‚ó°²âºâ»î â¼â½â¾ó°ºó°»ó°¸ó°¹Ëœâ—Œâ—Œâ—Œâ—Œâ—Œêœ ó°¦¥ó°¦¥ó°¦¥ó°¦¥ó°¦¥

DAT = â›
ó°¦¥ó°¦¥ó°¦¥ó°¦¥ó°¦¥

Â¡alpha  âŸ¦abcdefghijklmnopqrstuvwxyzâŸ§
Â¡ALPHA  âŸ¦ABCDEFGHIJKLMNOPQRSTUVWXYZâŸ§
Â¡number âŸ¦0123456789                âŸ§
Â¡letter âŸ¦âŸ¨@alphaâŸ©âŸ¨@ALPHAâŸ©          âŸ§
Â¡letnum âŸ¦âŸ¨@letterâŸ©âŸ¨@numberâŸ©        âŸ§
Â¡greek â¦‘câ¦‘A00â¦’â¦’ âŸ¦
  â…âŸ¦â…_sâ†â…0âŸ¦-á¦vâŸ§â†abâ…dâŸ¦egpá¦âŸ§â†â…eâŸ¦á¦tâŸ§â†â…fâŸ¦eiâŸ§â†â…Fiâ†â…ioâ†âŸ§ğ•Š âŸ¶
      Ï‚    Î˜Î¸Ï‘  Î±Î²   Î´âˆ‡âˆ‚Î”     ÎµÎ·     Ï†Ï•    Î¦   Î¹  â†
  â…âŸ¦klâ…muâ†â…pâŸ¦á¦sâŸ§â†â…PâŸ¦á¦sâŸ§â†â…rhâ†sStâ…upâ†vwWâ…xâŸ¦iá¦âŸ§â†yYzZâŸ§ğ•Š âŸ¶
    ÎºÎ»  Î¼    Ï€Î¨     Î Ïˆ    Ï ÏƒÎ£Ï„  Ï… Î½Ï‰Î©   ÎÏ‡  Î³Î“Î¶Î¾ â†
âŸ§

Â¡lngeek âŸ¦âŸ¨@letnumâŸ©â…á´âŸ¨@greekâŸ©â†âŸ§

Â¡dstruk qâŸ¨@letnumâŸ© âŸ¶ ğ”¸ğ”¹â„‚ğ”»ğ”¼ğ”½ğ”¾â„ğ•€ğ•ğ•‚ğ•ƒğ•„â„•ğ•†â„™â„šâ„ğ•Šğ•‹ğ•Œğ•ğ•ğ•ğ•â„¤ğ•’ğ•“ğ•”ğ••ğ•–ğ•—ğ•˜ğ•™ğ•šğ•›ğ•œğ•ğ•ğ•Ÿğ• ğ•¡ğ•¢ğ•£ğ•¤ğ•¥ğ•¦ğ•§ğ•¨ğ•©ğ•ªğ•«ğŸ˜ğŸ™ğŸšğŸ›ğŸœğŸğŸğŸŸğŸ ğŸ¡

wâŸ¦
  Â¡bold       bâŸ¨@lngeekâŸ© â¦‘câ¦‘ff9dc6â¦’â¦’ ó°…ğšğ›ğœğğğŸğ ğ¡ğ¢ğ£ğ¤ğ¥ğ¦ğ§ğ¨ğ©ğªğ«ğ¬ğ­ğ®ğ¯ğ°ğ±ğ²ğ³ğ€ğğ‚ğƒğ„ğ…ğ†ğ‡ğˆğ‰ğŠğ‹ğŒğğğğğ‘ğ’ğ“ğ”ğ•ğ–ğ—ğ˜ğ™ğŸğŸğŸğŸ‘ğŸ’ğŸ“ğŸ”ğŸ•ğŸ–ğŸ—ğğğ·ğ‹ğ°ğ±ğ³ğ¯ğ‰ğ™ğ´ğ¶ğ…ğ«ğğ¸ğ¹ğºğ»ğ¿ğ‡ğ¥ğ­ğ€ğ‚ğ¨ğƒğ„ğ¼ğˆğ®ğ£ğ†ğ²ğ˜ğµğ½ ó°…‚
  Â¡ital       iâŸ¨@lngeekâŸ© â¦‘câ¦‘f6b845â¦’â¦’ ó°…ğ‘ğ‘ğ‘ğ‘‘ğ‘’ğ‘“ğ‘”â„ğ‘–ğ‘—ğ‘˜ğ‘™ğ‘šğ‘›ğ‘œğ‘ğ‘ğ‘Ÿğ‘ ğ‘¡ğ‘¢ğ‘£ğ‘¤ğ‘¥ğ‘¦ğ‘§ğ´ğµğ¶ğ·ğ¸ğ¹ğºğ»ğ¼ğ½ğ¾ğ¿ğ‘€ğ‘ğ‘‚ğ‘ƒğ‘„ğ‘…ğ‘†ğ‘‡ğ‘ˆğ‘‰ğ‘Šğ‘‹ğ‘Œğ‘â—Œâ—Œâ—Œâ—Œâ—Œâ—Œâ—Œâ—Œâ—Œâ—Œğ‡ğœ£ğœ½ğ‘ğœ¶ğœ·ğœ¹ğœµğğœŸğœºğœ¼ğ‹ğœ±ğ“ğœ¾ğœ¿ğ€ğğ…ğğœ«ğœ³ğ†ğˆğœ®ğ‰ğŠğ‚ğğœ´ğœ©ğŒğœ¸ğœğœ»ğƒ ó°…‚
  Â¡math,bold  sâŸ¨@letnumâŸ© â¦‘ â¦’ âŸ¶ ğ—®ğ—¯ğ—°ğ—±ğ—²ğ—³ğ—´ğ—µğ—¶ğ—·ğ—¸ğ—¹ğ—ºğ—»ğ—¼ğ—½ğ—¾ğ—¿ğ˜€ğ˜ğ˜‚ğ˜ƒğ˜„ğ˜…ğ˜†ğ˜‡ğ—”ğ—•ğ—–ğ——ğ—˜ğ—™ğ—šğ—›ğ—œğ—ğ—ğ—Ÿğ— ğ—¡ğ—¢ğ—£ğ—¤ğ—¥ğ—¦ğ—§ğ—¨ğ—©ğ—ªğ—«ğ—¬ğ—­ğŸ¬ğŸ­ğŸ®ğŸ¯ğŸ°ğŸ±ğŸ²ğŸ³ğŸ´ğŸµ
  Â¡frak       fâŸ¨@letnumâŸ© â¦‘ â¦’ âŸ¶ ğ”ğ”Ÿğ” ğ”¡ğ”¢ğ”£ğ”¤ğ”¥ğ”¦ğ”§ğ”¨ğ”©ğ”ªğ”«ğ”¬ğ”­ğ”®ğ”¯ğ”°ğ”±ğ”²ğ”³ğ”´ğ”µğ”¶ğ”·ğ”„ğ”…â„­ğ”‡ğ”ˆğ”‰ğ”Šâ„Œâ„‘ğ”ğ”ğ”ğ”ğ”‘ğ”’ğ”“ğ””â„œğ”–ğ”—ğ”˜ğ”™ğ”šğ”›ğ”œâ„¨â—Œâ—Œâ—Œâ—Œâ—Œâ—Œâ—Œâ—Œâ—Œâ—Œ
  Â¡frak,bold  FâŸ¨@letnumâŸ© â¦‘ â¦’ âŸ¶ ğ–†ğ–‡ğ–ˆğ–‰ğ–Šğ–‹ğ–Œğ–ğ–ğ–ğ–ğ–‘ğ–’ğ–“ğ–”ğ–•ğ––ğ–—ğ–˜ğ–™ğ–šğ–›ğ–œğ–ğ–ğ–Ÿğ•¬ğ•­ğ•®ğ•¯ğ•°ğ•±ğ•²ğ•³ğ•´ğ•µğ•¶ğ•·ğ•¸ğ•¹ğ•ºğ•»ğ•¼ğ•½ğ•¾ğ•¿ğ–€ğ–ğ–‚ğ–ƒğ–„ğ–…â—Œâ—Œâ—Œâ—Œâ—Œâ—Œâ—Œâ—Œâ—Œâ—Œ
  Â¡mathscript mâŸ¨@letnumâŸ© â¦‘ â¦’ âŸ¶ ğ’¶ğ’·ğ’¸ğ’¹â„¯ğ’»â„Šğ’½ğ’¾ğ’¿ğ“€ğ“ğ“‚ğ“ƒâ„´ğ“…ğ“†ğ“‡ğ“ˆğ“‰ğ“Šğ“‹ğ“Œğ“ğ“ğ“ğ’œâ„¬ğ’ğ’Ÿâ„°â„±ğ’¢â„‹â„ğ’¥ğ’¦â„’â„³ğ’©ğ’ªğ’«ğ’¬â„›ğ’®ğ’¯ğ’°ğ’±ğ’²ğ’³ğ’´ğ’µâ—Œâ—Œâ—Œâ—Œâ—Œâ—Œâ—Œâ—Œâ—Œâ—Œ
  Â¡para       pâŸ¨@letnumâŸ© â¦‘Nâ¦’ âŸ¶ â’œâ’â’â’Ÿâ’ â’¡â’¢â’£â’¤â’¥â’¦â’§â’¨â’©â’ªâ’«â’¬â’­â’®â’¯â’°â’±â’²â’³â’´â’µğŸ„ğŸ„‘ğŸ„’ğŸ„“ğŸ„”ğŸ„•ğŸ„–ğŸ„—ğŸ„˜ğŸ„™ğŸ„šğŸ„›ğŸ„œğŸ„ğŸ„ğŸ„ŸğŸ„ ğŸ„¡ğŸ„¢ğŸ„£ğŸ„¤ğŸ„¥ğŸ„¦ğŸ„§ğŸ„¨ğŸ„©â—Œâ‘´â‘µâ‘¶â‘·â‘¸â‘¹â‘ºâ‘»â‘¼
  Â¡circle     câŸ¨@letnumâŸ© â¦‘Nâ¦’ âŸ¶ â“â“‘â“’â““â“”â“•â“–â“—â“˜â“™â“šâ“›â“œâ“â“â“Ÿâ“ â“¡â“¢â“£â“¤â“¥â“¦â“§â“¨â“©â’¶â’·â’¸â’¹â’ºâ’»â’¼â’½â’¾â’¿â“€â“â“‚â“ƒâ“„â“…â“†â“‡â“ˆâ“‰â“Šâ“‹â“Œâ“â“â“â—Œó°²¡ó°²£ó°²¥ó°²§ó°²©ó°²«ó°²­ó°²¯ó°²±
  Â¡circlen2   CâŸ¨@numberâŸ© â¦‘Nâ¦’ âŸ¶                                                     â“ªâ‘ â‘¡â‘¢â‘£â‘¤â‘¥â‘¦â‘§â‘¨
âŸ§

â¦‘câ¦‘ff9dc6â¦’â¦’ â¦‘Nâ¦’ âŸ¦hiâŸ§ âŸ¶ AB

ó°¦¥ó°¦¥ó°¦¥ó°¦¥ó°¦¥

â¨¡ string as ğ’
â®Œ peggle â¨¡ Parser
ğŸŒˆ = ó°‹ºâˆ˜â›ğŸŒˆ
ó°‹º(â›ğ, â›ğ)
ó°‹º("multisupersubscriptify", â ¤â€¹load_fontâ€‰save_fontâ€‰add_scriptâ€‰add_multicharâ€ºâ­)
ó°‹º("organizer", â€¹get_codepointsâ€º)


GRAM = â›
ó°¦¥ó°¦¥ó°¦¥ó°¦¥ó°¦¥
main = (ó°†´W âˆ¨ concat)*

atom = ó°†´w? â†· (macadd âˆ¨ macref âˆ¨ results âˆ¨ style âˆ¨ p_looper âˆ¨ p_concat âˆ¨ lookup)

macadd = ó°†´'Â¡' (ó°†´W? â†· (ó°†´',' â¯† word)) concat
macref = ó°†´'âŸ¨' ó°†´W? â†· (
      (macref_tag  =(ó°†´@ word))
    âˆ¨ (macref_notag=(   word))
) ó°†´'âŸ©'

results = (
    (ó°†´(W? 'ó°…') (ó°†´W âˆ¨ str âˆ¨ ~â€¹[^ó°…‚]â€º)* ó°†´'ó°…‚')
   âˆ¨(ó°†´âŸ¶        (ó°†´w âˆ¨ str âˆ¨ ~â€¹[^âŸ§â†âŸ©\n\t ]â€º)*)
)

style = ó°†´'â¦‘' (ó°†´W? â†· (â ¶tuple âˆ¨ âœ“)) ó°†´'â¦’'
tuple = ((| (| âœ“)*)? chain)+
pair  = Æ¨(word) ó°†´W? â¦‘ â ¶tuple? â¦’
chain = (pair âˆ¨ word)+ ó°†´W?

concat = (â ¶atom)+
p_looper = ó°†´'âŸ¦' (ó°†´W âˆ¨ â ¶atom)* ó°†´'âŸ§'
p_concat = ó°†´'â…' (ó°†´W âˆ¨ â ¶atom)* ó°†´'â†'

lookup = str âˆ¨ Æ¨(chr âˆ¨ '|' âˆ¨ ',')
word   = Æ¨(str âˆ¨ chr+)
str    = Æ¨(â ¶esc âˆ¨ (ó°†´'"' ((esc âˆ¨ ~â€¹[^"]â€º)*) ó°†´'"'))
esc    = ó°†´â€¹â›â›â€º ~â€¹.?â€º

chr = Â¬bad ~â€¹.â€º
bad = ~â€¹["âŸ¨âŸ©âŸ¦âŸ§â…â†â¦‘â¦’Â¡,|\t\n ]â€º

w = ~â€¹[ \t]+â€º
W = ~â€¹[ \t\n]+â€º

(âŸ¦=ó°†´(W?â†·'âŸ¦'))(âŸ§=ó°†´(W?â†·'âŸ§'))(â…=ó°†´(W?â†·'â…'))(â†=ó°†´(W?â†·'â†'))
(â¦‘=ó°†´(W?â†·'â¦‘'))(â¦’=ó°†´(W?â†·'â¦’'))(âŸ¨=ó°†´(W?â†·'âŸ¨'))(âŸ©=ó°†´(W?â†·'âŸ©'))
(ó°…=ó°†´(W?â†·'ó°…'))(ó°…‚=ó°†´(W?â†·'ó°…‚'))(âŸ¶=ó°†´(W?â†·'âŸ¶'))(Â¡=ó°†´(W?â†·'Â¡'))
(|=ó°†´(W?â†·'|'))(@=ó°†´(W?â†·'@'))(,=ó°†´(W?â†·','))
ó°¦¥ó°¦¥ó°¦¥ó°¦¥ó°¦¥

symmap = {
        â›(: "parenleft"  , â›): "parenright"  ,
        â›{: "braceleft"  , â›}: "braceright"  ,
        â›[: "bracketleft", â›]: "bracketright",
        â›<: "less"       , â›>: "greater"     ,
        â›+: "plus"       , â›-: "minus"       ,
        â›/: "slash"      , â›\: "backslash"   ,
        â›!: "exclam"     , â›?: "question"    ,
        â›@: "at"         ,
        â›.: "period"     , â›,: "comma"       ,
        â›:: "colon"      , â›;: "semicolon"   ,
        â›&: "ampersand"  , â›%: "percent"     ,
        â›=: "equal"      , â›*: "asterisk"    ,
        â›_: "underscore" , â›|: "bar"         ,
        â›^: "asciicircum", â›~: "asciitilde"  ,
        â›#: "numbersign" , â›$: "dollar"      ,
        â›': "apostrophe" , â›": "quotedbl"    ,
        â›ğ•Š: "space"      , â›á´: "Multi_key"   ,
        â ¶ğ‘‘(ğ’.ascii_letters+ğ’.digits á´ó°²¡xâ‹„êœ ) }

fargs = Æ’â†¦Æ’.__code__.co_varnames[:Æ’.__code__.co_argcount]
âŠ¢ hsh(s):
        Â¿á¹(s, ğ‘‘): â†ª ğ‘¡((k,hsh(v))âˆ€k,vâˆˆs.itemsî®¦)
        Â¿á¹(s, ğ‘™): â†ª ğ‘¡(hsh(v) âˆ€vâˆˆs)
        â†ª s

gen, gens = nâ†¦Æ’â†¦gensâ‚™â‰”Æ’, {}
gen(â›c)â†â¥Œx=â–¡,y=â–¡,z=â–¡â†¦{ â ¶xâˆ§{          "color": ğŸŒˆ.h2hlâ†x}âˆ¨{},
                       â ¶yâˆ§{"backgroundColor": ğŸŒˆ.h2hlâ†y}âˆ¨{},
                       â ¶zâˆ§{    "borderColor": ğŸŒˆ.h2hlâ†z}âˆ¨{} }
gen(â›B)â†â¥Œx,y=1,r=1â†¦â„µ(borderStyle  = â€¹sâ€‰solidâŸdâ€‰dashedâ€ºâ­â¥‰ğ‘‘â†’â‚“,
                     borderWidth  = â€¹âŸ¦yâŸ§pxâ€º,
                     borderRadius = â€¹âŸ¦râŸ§pxâ€º)
gen(â›b)â†ğš²â„µ(fontStyle="bold")
gen(â›N)â†ğš²â„µ(NO_SCALE=â´³)
gen(â›u)â†â¥Œx=1â†¦â„µ(textDecoration=â€¹underline âŸ¦xâŸ§pxâ€º)
âŠ¢ decor(n, multi=â´´):
    R = []
    âˆ€nâˆˆn:
        r = {}
        âˆ€nâˆˆn:
            t, v = náµ—, ná¶œ
            Â¿t â‰¡ "word":
                r |= gens[vâ‚€áµ—]î®¦
            â¸˜t â‰¡ "pair":
                t, c = vâ‚€áµ—, vâ‚á¶œ
                É™ = c á´ó°²¡â–¡ Â¿xáµ—â‰¡â›âœ“Â¡ ğ˜€.join(x.extract(ó°²¡Â¬xá¶œ,Î”=âœ—)á´ó°²¡xáµ—)
                Æ’ = gensâ‚œ
                r |= Æ’(â ¶{k:vâˆ€k,vâˆˆfargs(Æ’)Î¶É™Â¿kâ‰‡â–¡})
        R += râ›¶
    â†ª RÂ¿multiÂ¡Râ‚€

âŠ¢ supermcdoublerecursivecomposeoutputstyleparsemachine(
        n, pre=â–¡, mac=â–¡, res=â–¡):
    
    mac, pre, res = {}Â¿macâ‰…â–¡Â¡mac, []Â¿preâ‰…â–¡Â¡pre, []Â¿resâ‰…â–¡Â¡res
    ğ•¤ = ğš²supermcdoublerecursivecomposeoutputstyleparsemachine(â ¤ğ”¸,mac=mac,res=res)
    Â¿náµ—â‰¡"main":
        ğ•¤(n.copy(t="looper"),pre)
        â†ª mac, res
    Â¿náµ—â‰¡"looper": â†ª ná´ó°²¡ğ•¤(x,pre)ó°…‚Î£[]
    Â¿náµ—â‰¡"concat":
        seqs, L = [pre], ná´ó°²¡x
        â°L:
            N = L.popâˆ˜0
            nseqs = []
            âˆ€pâˆˆseqs:
                nseqs += ğ•¤(N, p) î¬¦ [seq]
            seqs = nseqs
        â†ª seqs
    Â¿náµ—â‰¡"style":  â†ª [[â ¤pre, ("STYLE", nâ‚€áµ—)]]
    Â¿náµ—â‰¡"lookup": â†ª [pre+(("LIT", nâ‚€ â‚€áµ—)Â¿nâ‚€áµ—â‰¡"str"Â¡nâ‚€áµ—)â›¶] î¬¦ ó°¤± strs (ó·¹‡ they special!)
    Â¿náµ—â‰¡"results":
        C, â ¤ná¶œ = n
        res.append((pre, (Câ‚€Â¿CğŸƒŒÂ¡C)áµ—))
        â†ª [pre]
    Â¿náµ—â‰¡"macadd":
        â ¤w, s = n
        seqs = ğ•¤(s, pre +â† wá´ó°²¡("TAG", xâ‚€áµ—))
        w á´ó°²¡mac.setdefault(xâ‚€áµ—,[]).extend(seqs)
        â†ª seqs
    Â¿náµ—â‰¡"macref":
        n = nâ‚€
        val = mac[nam â‰” nâ‚€ â‚€áµ— Öó°¤±ôŠ½¨Ö]
        Â¿náµ—â‰¡"macref_tag":
            â–¡ î¬¦pre += [("TAG", nam)]
        Â¡:
            val á´= ó°²¡x ó°ˆ³ó°²¡xá¹ğ‘¡âˆ§xâ‚€â‰¡"TAG"
        â†ª val á´ó°²¡pre+x

head_types = â€¹R_S_Câ€‰R_S_0â€‰R_C_Sâ€‰R_Câ€‰R_S_1â€ºâ­
âŠ¢ parse(dat, gram=Parser(GRAM), SCRIPT_EXIST=SCRIPT_EXIST):
    dat = ğ—».joinâ†dat.split(ğ—»)ó°ˆ³ó°²¡x.lstrip().startswithâ†â›î¬¦ó°…‚
    
    root = gram(datğŸŸ‘, DEBUG=âœ“, ONLY_NAMED=âœ“ğŸŸ‘) î¬¦ â† most perf optmz herez
    root = root.child_killer(ó°²¡xáµ—âˆˆğ‘ â†â€¹â„œÂ¡|â›âŸ¦â›âŸ§â…â†â¦‘â¦’âŸ¨âŸ©âŸ¶â€º)
    root = root.find_replace(ó°²¡âœ“, ó°²¡(xáµ—âˆ§(xáµ—,xá¶œ)âˆ¨(xá¶œ,[])))
    root = (repâ‰”ó°²¡ğ(x)Â¿xá¹á”Â¡ğ(xâ‚€,â ¤xâ‚á´rep))âˆ˜root
    root = root.ftrp("strâ€‰word"â­, ó°²¡x.copy(xáµ—, c=[ğ(xá´ó°²¡xáµ—ó°…‚Î£á¦)]))
    root = root.ftrp("style"â­, ó°²¡x.copy(c=[ğ(decor(x))]))
    root = root.ftrp("p_looper"â­, ó°²¡x.copy("looper"), âœ“)
    root = root.ftrp("p_concat"â­, ó°²¡x.copy("concat"), âœ“)
    mac, lets = supermcdoublerecursivecomposeoutputstyleparsemachine(root)
    
    lets êŸ¿= ó°²£x î®† ó°²¡xá¹ğ‘¡âˆ§xâ‚€âˆˆ(â€¹TAGâ€‰STYLEâ€ºâ­)âˆ§xâ‚€ó°…‚ â¥‰ â›
               ó°²¡(x.pop(âœ—), (x êŸ¿â±½ó°²£ yá´ ó°²¡xâ‚ó°…‚))ó°…‚ â›
             â†’+yâ›¶áµ€
    
    î¬¦ letsêŸ¿ğš²ğ˜€.joinâ†ğ”¸á´á”â†’â˜¾
    
    res = {}
    â° lets:
        C = (S, ğ­, c) = lets.popâˆ˜0
        ns = á¦
        âˆ€sâˆˆS:
            Â¿sâ‰¡â›á¦: â†º
            Â¿sá¹ğ‘¡:
                â¨³ sâ‚€â‰¡"LIT"
                Â¿sâ‚âˆˆres: â‡¥
                ns += res[sâ‚]â‚€ â‚€
            â¸˜sâˆˆsymmap: ns += s
            â¸˜sâˆˆ   res: ns += resâ‚› â‚€ â‚€
            Â¡: â‡¥
        Â¡:
            Â¿câ‰¡â›â—Œ: â†º î¬¦ make a quoted â—Œ work
            res.setdefault(c,[]).append((ns,ğ­))
            â†º
        lets.append(C)
    
    âˆ€câˆˆres:
        seqs = resî á´ó°²¡xâ‚€
        styles, tags = {}, []
        âˆ€k,vâˆˆ(resî  êŸ¿ ó°²£y.itemsî®¦â¥‰ğ‘™ó°…‚ Î£[]):
            Â¿kâ‰¡"STYLE": styles |= (v Å¿ |)
            â¸˜kâ‰¡  "TAG":   tags += v
        resî  = â„µ(
            T="reg",
            out=c,
            seqs=seqs,
            tags=tags,
            style=styles)
    
    SCRIPT_EXIST = SCRIPT_EXIST.strip().split(ğ—») á´ á”.strip êŸ¿â° Î¶Â´ êŸ¿ó°²¥(x,yâ‹„z)ó°…‚ â¥‰ ğ‘‘
    already_script = ó°²£jâ‰”SCRIPT_EXIST.get(x,â´´)â†’âˆ§(â›â—Œâ‰ Hâ‰”j[yâ‰¡â›p] â†’âˆ§H)
    
    â®Œ pathlib â¨¡ Path as ğ©
    ğ’» = load_font(ğ©âˆ˜"Output/JuliaMono-Regular_Nerd_CustomSymbols.ttf") î¬¦
    get_psuedo_seqs = câ†¦câ›¶ Â¿câˆˆsymmapÂ¡ resî Ë¢áµ‰î ‡Ë¢ Â¿câˆˆresÂ¡ â–¡
    make_script_seq_pre = â¥Œp,s,câ†¦pâ‹…(2-â†câˆˆsymmap)+(â›ğ•ŠÂ¿câ‰¡pÂ¡s) î¬¦ áµƒ:\a ó°Œ:\\ağ•Š ô‹‘ª:\ğ•Š
    
    âˆ€kâˆˆ(symmap ó°ˆ³ó°²¡xâˆˆ"á´ğ•Š"âˆ¨xâˆˆres):
        resâ‚– = â„µ(T="NC", out=k, seqs=get_psuedo_seqs(k),
                 tags=[], style={})
    
    âˆ€sâˆˆMULTICHARS.stripî®¦â­:
        Â¿Â¬gsâ‰”(sá´ó°²¡xâˆˆresó°…‚â†’â‹€): â€¹Multi "âŸ¦sâŸ§" has no sequence.â€º
        resâ‚› = â„µ(
            T      = "mul",
            out    = â–¡,
            parent = s,
            seqs   = [â€¹á´âŸ¦sá´ó°²¡resâ‚“.seqsâ‚€+â›ğ•Šó°…‚Î£á¦âŸ§â€º] Â¿gsÂ¡ [],
            tags   = sá´ó°²¡(resâ‚“.tags Â¿ xâˆˆresÂ¡ [])ó°…‚Î£[],
            style  = res[sâ‚€].style Â¿sâ‚€âˆˆresÂ¡ {})
    chars = res.valuesî®¦ó°ˆ²ó°²¡xáµ€â‰¡"mul"
    bases = chars á´ó°²¡xáµ–áµƒÊ³áµ‰â¿áµ—
    out_chars = get_codepoints(bases, "mul")
    âˆ€n,c âˆˆ charsÎ¶out_chars:
        add_multichar(ğ’», câ‚€, câ‚, câ‚‚)
        res[náµ’áµ˜áµ— â‰” câ‚€] = n
    
    G = to_subs, to_sups = [], []
    âˆ€k,vâˆˆres.itemsî®¦:
        âˆ€ğ”­,â’¨,gâˆˆÎ¶Â´(â€¹/\â€º, â€¹subâ€‰supâ€ºâ­, G):
            g.append(â„µ(
                T=â’¨, parent=k,
                out = already_script(k, â’¨â‚‹â‚) âˆ¨ â–¡,
                seqs=vË¢áµ‰î ‡Ë¢ á´ó°²¡make_script_seq_pre(ğ”­,x,k),
                tags=váµ—áµƒáµË¢ + â’¨â›¶,
                style=vË¢áµ—Ê¸Ë¡áµ‰))
    âˆ€kâˆˆFORCE_INCLUDE:
        âˆ€â’¨âˆˆâ€¹subâ€‰supâ€ºâ­:
            g.append(â„µ(T=â’¨, parent=k, out=â–¡, seqs=[], tags=â’¨â›¶, style=[]))
    
    âˆ€â’¨,gâˆˆÎ¶Â´(â€¹subâ€‰supâ€ºâ­, G):
        chars = g ó°ˆ²ó°²¡xáµ’áµ˜áµ—â‰¡â–¡ âˆ§ xáµ–áµƒÊ³áµ‰â¿áµ—ğŸƒŒâ‰¡1 î¬¦ ó°¤± make multis workkk
        bases = chars á´ó°²¡xáµ–áµƒÊ³áµ‰â¿áµ—
        out_chars = get_codepoints(bases, â’¨)
        âˆ€n,c âˆˆ charsÎ¶out_chars:
            add_script(ğ’», câ‚€, câ‚, câ‚‚, â’¨â‚‹â‚, "NO_SCALE"âˆ‰n.style)
            res[náµ’áµ˜áµ— â‰” câ‚€] = n
    
    stylez = {}
    âˆ€k,vâˆˆres.itemsî®¦:
        stylez.setdefault(hsh(v.style), (v.style, []))â‚.append(k)
    stylez = stylez.valuesî®¦êŸ¿ó°²£(x.pop("NO_SCALE", â–¡)â–ºx,yÎ£á¦)
    
    res.itemsî®¦êŸ¿ó°²£â€¹âŸ¦xâŸ§: âŸ¦yË¢áµ‰î ‡Ë¢âŸ§â€ºâ˜¾
    
    save_font(ğ’», ğ©âˆ˜"Output/AQWESEOME.ttf")
    
    î¬¦ get_codepoints("")â˜¾
    î¬¦ to_subsâ˜¾
    î¬¦ resâ˜¾

parseâˆ˜DAT

î¬¦ ó°¤± auto insert sub/sup versions
î¬¦ ó°¤± add section for composite characters
    î¬¦ ó°¤± color default derived from first char
î¬¦ ó°¤± add section for "style âŸ¶ rgx"
î¬¦ ó°¤± the rest of it

ğŸŸ‘
non-pre: allow running process to continue until the proc terms or blcosk a resource
preemptive: may stop cur run proc and choose another proc to run.

upside down 1 for -1?
ğŸŸ‘
î¬¦ maybe add a thing that disallows base symmap keys from generating even if inside the compose so we can style em?