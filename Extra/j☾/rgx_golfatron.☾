ch1, ch2 = â€¹ğ—»\^$.|?*+()[]{}â€º, â€¹\]-â€º
ST = 0x10FF50
CFâ‰”(CTâ‰”â„µ(ch1+ch2â†’áš¤â†’â†¨êŸ¿âˆ¾ó·º¹â‹„â†ó·¹â†        ST+ó·º½)) á´á´° á´™
IFâ‰”(ITâ‰”â„µ(ch1+ch2â†’áš¤â†’â†¨êŸ¿âˆ¾ó·º¹â‹„â†ó·¹â†    ğŸƒŒCF+ST+ó·º½)) á´á´° á´™
OFâ‰”(OTâ‰”â„µ(ch1    â†’áš¤â†’â†¨êŸ¿âˆ¾ó·º¹â‹„â†ó·¹â†ğŸƒŒIF+ğŸƒŒCF+ST+ó·º½)) á´á´° á´™
CT, IT, OT = CTâ‹„ITâ‹„OT áµêŸ¿á´·ó°²£xó·¹
CF, IF, OF = CFâ‹„IFâ‹„OF áµêŸ¿á´·ó°²£xó·¹
ch2á–IFô´–ó°‚›ó°‚¦ô¶¢ô«†â‰”â›\+âŸ
OF = OFêŸ¿â±½ó°²£â›\+y
DASH = CTô´–ôŠ¯›â‚‹
BL,BR = CTô´–ôŠ¯›ó°„—, CTô´–ôŠ¯›ó°„˜
PL,PR = CTô´–ôŠ¯›â‚, CTô´–ôŠ¯›â‚
Q,BAR = CTô´–ôŠ¯›ï¹–, CTô´–ôŠ¯›ô‹• 
âŠ¢ rgx_rans(x):
    x ó°’¼= ğœ¶â‰”ó°²¡ord(xâ‚€)
    r = []
    âˆ€âŸ âˆˆ xá™¡ô‹‚êœ:
        h = âŸá´ğœ¶
        r.append(hâ‚€+hâ‚+hâ‚‚â‰¡3hâ‚€+3 â­œDASHâ­ âŸâ‚)
    r Å¿= ó°²£x+yâ‹…â†yô¨„â‰ xô¨„
    â†ª r.translate(IT)
â®Œfunctoolsâ¨¡cache
âŠ¢ rgx_golfatron(ğ•):
    @cache
    âŠ¢ ğ¼(x):
        t, Ï‡ = xî®†á´®
        â†ª Ï‡î®†ó°²¡xâ‚€ó°…‚â¥‰â„µâ†’êŸ¿ó°²£x, ğ¼(Hâ‰”ğ‘¡(yá´ó°²¡xâ‚ï¹•)), á¦âˆˆHâˆ§Hâ‹â­œ1â­0ó°…‚
    âŠ¢ Ï™(x):
        s, m = x î®†á´® ó°²¡len(x)â‰ 1
        má´=ó°²¡á¦.join(x.translate(OT))
        Â¿sâ‰”á¦.join(s): m.append(sğŸƒŒâ‰¡1 â­œs.translate(OT)â­ BL+rgx_rans(s)+BR)
        â†ª m
    âŠ¢ Å§(x):
        Î±,Î²,Î³=x
        r = Î±
        Â¿Î²âˆ§Î²â‰”Ï™(Î²á´Å§):
            h = BAR.join(Î²)
            Â¿Î±âˆ§len(Î²)>1: h = PL+h+PR
            r += h
        â†ª Î³âˆ§Î± â­œr+Qâ­ r
    ğ• = ğ¼(ğ‘¡(sorted(ğ•,key=ó°²¡Â¯len(x),xó°…‚)))
    â†ª Å§((á¦,ğ•,âœ—)).translate(CF).translate(IF).translate(OF)