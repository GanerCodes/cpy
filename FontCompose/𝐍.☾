â®Œ util â¨¡ Z

Î© ğ:
    âŠ¢ __init__(ğ•Š, t, â ¤c): ğ•Š.t, ğ•Š.c = t, câˆ¨[]
    __iter__ = ğ•Šâ†¦iter(ğ•Š.c)
    __repr__ = ğ•Šâ†¦â€¹ğâŸ¨âŸ¦ğ•Šáµ—âˆ¨â›âˆ…âŸ§âŸ©âŸ¨âŸ¦", ".join(ğ•Šá´á”)âŸ§âŸ©â€º
    __getitem__ = â¥Œğ•Š,iâ†¦ğ•Šá¶œáµ¢
    __len__  = ğ•Šâ†¦ğ•Šá¶œğŸƒŒ
    tt = ğ•Šâ†¦(ğ•Šáµ—,ğ•Šá¶œá´ó°²¡xáµ—áµ—î®¦Â¿xá¹ğÂ¡x)
    ft = ğ’®â„³â†ó°²¡ğ(xâ‚€,â ¤xâ‚á´ğá¶ áµ—Â¿xâ‚á¹ğ‘™|ğ‘¡âˆ§xâ‚ğŸƒŒâ‰¡2Â¡xâ‚â›¶)
    copy  = â¥Œğ•Š,t=â–¡,c=â–¡â†¦ğ(ğ•Šáµ—Â¿tâ‰…â–¡Â¡t, â ¤ğ•Šá¶œÂ¿câ‰…â–¡Â¡c)
    rcopy = â¥Œğ•Š,t=â–¡â†¦ğ(ğ•Šáµ—Â¿tâ‰…â–¡Â¡t, â ¤ğ•Šá¶œá´ğ.rcopy)Â¿ğ•Šá¹ğÂ¡ğ•Š
    frp = â¥Œğ•Š,f,r,pre=âœ—â†¦((mkâ‰”ó°²¡x.copy(c=xá´ó°²¡x.frp(f,r,pre))) â–º (r(ğ•Š) Â¿f((ğ•Šâ‰”mk(ğ•Š))Â¿preÂ¡ğ•Š)Â¡ (ğ•ŠÂ¿preÂ¡mk(ğ•Š))))
    ftrp = â¥Œğ•Š,fs,r,pre=âœ—â†¦ğ•Š.frp(ó°²¡xáµ—âˆˆfs, r, pre)
    âŠ¢ extract(ğ•Š, f, E=â–¡, Î²=âœ“, Î”=âœ—, pre=âœ—):
        L = r, E = [[], []Â¿(Ïâ‰”Eâ‰…â–¡)Â¡E]
        ğ€ = ó°²¡ğ.extract(x,f,E,pre=pre)
        ğ•Šá´ó°²¡L[ğ‘â†fâ†xâ‰”x á£†áµ–Ê³áµ‰ ğ€].append(x)
        n = ğ•Š.copy(c=r Â¿preÂ¡ rá´ğ€)
        
        â†ª ((n, E) Â¿Î”Â¡ E) Â¿Ïâˆ§Î²Â¡ n
    filter = â¥Œğ•Š,fâ†¦ğ•Š.extract(Â¬â—‹f,â ¤ğ”¸,â ¶ğ•‚,Î²=âœ—,Î”=âœ—)
    
    âŠ¢ P(ğ•Š):
        clc = â¥Œx,c="BL"â†¦getattr(Z,c)+x+Záµ‚
        ML = ó°²¡xğŸƒŒ-â†(Záµ‚,Zá´®á´¸,Zá´¿á´±,Záµˆá´®á´¸)á´kâ†¦x.count(k)â‹…ğŸƒŒkó°…‚Î£0
        âŠ¢ box(x):
            (o, c), O, C = â€¹[]â€‰â¡â¢â£â€‰â¤â¥â¦â€ºâ­á´Â²(ó°²¡clc(x,"dBL"))
            x = x.splitâ†ğ—»
            Â¿ğŸƒŒxâ‰¡1: â†ªâ€¹âŸ¦oâŸ§âŸ¦xâ‚€âŸ§âŸ¦câŸ§â€º
            ms = xá´MLâ†’â¤‰
            â†ª ğ—».join(x á™¡ êŸ¿ó°²¥(O[nâ‰”1-xâ‰…â–¡+zâ‰…â–¡]+y+(ms-ML(y))â‹…ğ˜€+Câ‚™))
        Â¿Â¬â†ğ•Šá¹ğ: â†ªá”âˆ˜ğ•Š
        âˆ… = clc(â›âˆ…, "RE")
        nam = (ğ•Šáµ—.Pî®¦Â¿ğ•Šáµ—á¹ğÂ¡á”âˆ˜ğ•Šáµ—) âˆ¨ âˆ…
        start = boxâˆ˜nam

        (â•´,â•®), m0, m1, m2 = â€¹â”€â”¬â€‰â”¬â”€â€‰â”œâ•°â€‰â”‚ â€ºâ­á´Â²clc

        Â¿ğ•ŠğŸƒŒÂ¬: â†ª â€¹âŸ¦startâŸ§âŸ¦â•´âŸ§âŸ¦âˆ…âŸ§â€º
        
        slns = start.split(ğ—»)
        res, ml = ğ—».join(slnsï¹•â‚‹â‚), ML(lneâ‰”slnsâ‚‹â‚)
        âˆ€i,zâˆˆâ†¨ğ•Š:
            l = (z.Pî®¦Â¿zá¹ğÂ¡á”âˆ˜z).splitâ†ğ—»
            e = iâ‰¡ğ•ŠğŸƒŒ-1
            lâ‚€  = (m1Â¿iÂ¡m0)â‚‘+lâ‚€
            lâ‚ï¹• =   lâ‚ï¹•á´ó°²¡m2â‚‘+x
            l = lá´ó°²¡mlâ‹…ğ˜€+x
            Â¿Â¬i:
                pre = â€¹âŸ¦startâŸ§â€º
                lâ‚€ = pre + ğ˜€â‹…(ml-ML(pre)) + lâ‚€[ml:]
            res += ğ—».join(l) + Â¬eâ‹…ğ—»
        â†ª res

__exports__ = â›ğ,